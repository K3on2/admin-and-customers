<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Information - Al Ayadi Al Sarea Cleaning Services</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link rel="stylesheet" href="booking.css">
</head>
<body>

<!-- Header -->
<header>
   <div class="logo-container">
    <img src="logo.png" alt="logo" class="logo-img">
    <div class="logo-text-group">
      <span class="logo-text">
        Al Ayadi <span class="highlight">Al</span> <span class="high">Sarea</span>
      </span>
      <span class="logo-subtext">Cleaning Services</span>
    </div>
  </div>

  <div id="menu-icon" class="menu-icon">
    <i class="fas fa-bars"></i>
  </div>

  <div class="nav-right" id="navMenu">
    <ul class="navlist">
      <li><a href="#" class="active" onclick =" home()">Home</a></li>
      <li><a href="#">About Us</a></li>
      <li><a href="#">FAQ</a></li>
      <li><a href="#">Contact Us</a></li>
    </ul>


     <div class="search-bar">
            <input type="text" placeholder="Search...">
            <i class="bx bx-search"></i>
        </div>
    </div>
</header>


<!-- Booking Section -->
<section class="booking-section">
    <div class="booking-card">
        <!-- Sidebar -->
        <ul class="booking-details">
            <li><i class="bx bx-user"></i> Customer Details</li>
            <li><i class="bx bx-calendar"></i> Date & Time</li>
            <li><i class="bx bx-brush"></i> Type of Cleaning</li>
            <li><i class="bx bx-group"></i> Preferred Cleaning Agents</li>
            <li><i class="bx bx-edit-alt"></i> Special Requests</li>
            <li><i class="bx bx-receipt"></i> Billing Summary</li>
            <li><i class="bx bx-check-circle"></i> Booking Confirmation</li>
        </ul>

        <!-- Form -->
<div class="booking-form">
  <h2>Booking Information</h2>

  <form id="bookingForm" action="calendar.html" method="get" novalidate>
    <label>Name:</label>
    <input type="text" id="name" required>

    <label>Contact Number:</label>
    <input 
    type="tel" 
    id="contact" 
    required
    pattern="^05\d{8}$"
    maxlength="10"
    placeholder="05XXXXXXXX"
    title="Please enter a valid UAE mobile number starting with 05 and followed by 8 digits">

    <label>Select Emirates:</label>
    <select id="emirates" required>
      <option value="" disabled selected>Select Emirates</option>
      <option>Sharjah, UAE</option>
      <option>Dubai, UAE</option>
      <option>Umm Al Quwain, UAE</option>
	  <option>Ajman, UAE</option>
    </select>

    <label>House/ Bld. Number:</label>
    <input type="number" id="houseNumber" required>

    <label>Complete Address:</label>
    <input type="text" id="address" required>

    <div class="btn-row">
      <button class="btn btn-back" id="cancelBtn" type="button" href="#" onclick="home()">Cancel Booking</button>
      <button class="btn btn-next" id="nextBtn" type="submit" disabled>Next</button>
    </div>
  </form>
</div>
</section>

<!-- Footer -->
<footer class="footer">
    <p>Â© 2025 Al Ayadi Al Sarea Cleaning Services. All rights reserved.</p>
  </footer>

<script src="home.js"></script>
<!-- Firebase SDK -->
<script>
const bookingForm = document.getElementById('bookingForm');
const nameInput = document.getElementById('name');
const contactInput = document.getElementById('contact');
const emiratesSelect = document.getElementById('emirates');
const houseInput = document.getElementById('houseNumber');
const addressInput = document.getElementById('address');
const nextBtn = document.getElementById('nextBtn');
const cancelBtn = document.getElementById('cancelBtn');

// Load saved data
const savedData = JSON.parse(localStorage.getItem("bookingForm") || "{}");
if (savedData.name) nameInput.value = savedData.name;
if (savedData.contact) contactInput.value = savedData.contact;
if (savedData.emirates) emiratesSelect.value = savedData.emirates;
if (savedData.houseNumber) houseInput.value = savedData.houseNumber;
if (savedData.address) addressInput.value = savedData.address;

// Save only personal info
function savePersonalInfo() {
    const existing = JSON.parse(localStorage.getItem("bookingForm") || "{}");
    const updated = {
        ...existing, // preserve calendar or other fields
        name: nameInput.value.trim(),
        contact: contactInput.value.trim(),
        emirates: emiratesSelect.value,
        houseNumber: houseInput.value.trim(),
        address: addressInput.value.trim()
    };
    localStorage.setItem("bookingForm", JSON.stringify(updated));
}

// Enable/disable Next button
function checkForm() {
    const contactPattern = /^05\d{8}$/;
    const filled =
        nameInput.value.trim() &&
        contactPattern.test(contactInput.value.trim()) &&
        emiratesSelect.value.trim() &&
        houseInput.value.trim() &&
        addressInput.value.trim();

    nextBtn.disabled = !filled;
    nextBtn.style.opacity = filled ? "1" : "0.5";
}

// Attach event listeners
[nameInput, contactInput, emiratesSelect, houseInput, addressInput].forEach(el => {
    el.addEventListener('input', () => { savePersonalInfo(); checkForm(); });
    el.addEventListener('change', () => { savePersonalInfo(); checkForm(); });
});

window.addEventListener('beforeunload', savePersonalInfo);
document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') savePersonalInfo();
});

checkForm();

// Form submission
bookingForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const contactPattern = /^05\d{8}$/;
    if (!contactPattern.test(contactInput.value.trim())) {
        alert("Please enter a valid UAE mobile number (e.g., 05XXXXXXXX).");
        contactInput.focus();
        return;
    }
    savePersonalInfo();
    bookingForm.submit();
});

// Cancel button clears only relevant data
cancelBtn.addEventListener('click', () => {
    const existing = JSON.parse(localStorage.getItem("bookingForm") || "{}");
    const updated = { ...existing };
    delete updated.name;
    delete updated.contact;
    delete updated.emirates;
    delete updated.address;
    delete updated.houseNumber;
	delete updated.booking;

    localStorage.setItem("bookingForm", JSON.stringify(updated));
    bookingForm.reset();
    checkForm();
    home();
});
</script>
</body>
</html>
